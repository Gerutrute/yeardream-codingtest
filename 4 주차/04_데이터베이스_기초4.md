# 4 주차 내용 정리

### 목차
1. [SQL과 함수](#1-sql과-함수)
2. [다수의 테이블 제어하기](#2-다수의-테이블-제어하기)


# 1. SQL과 함수
## COUNT
> 검색한 결과의 데이터 개수를 가져오는 내장 함수이며, NULL인 데이터는 제외된다.

```sql
SELECT COUNT(id) FROM book; -- book 테이블의 id 개수


SELECT COUNT(*) FROM book; -- book 테이블의 모든 데이터 개수
```
- *는 모든 데이터를 의미한다.



## LIMIT
> 테이블에서 출력하고자 하는 데이터의 개수를 제한하는 명령

```sql
SELECT * FROM book LIMIT 5; -- book 테이블의 모든 데이터 중 5개만 출력

SELECT * FROM book LIMIT 1, 5; -- book 테이블의 2번째부터 5개 출력
```
- 첫 번째 컬럼의 시작은 0부터 시작한다.
- 'LIMIT 1, 5' 는 2번째 데이터부터 5개를 의미한다.




## SUM & AVG
> 테이블의 **합계** 또는 **평균** 값을 구할 때 사용하는 집계 함수

```sql
-- 모든 책의 가격(price)을 합산
SELECT SUM(price) FROM book;

-- 모든 책의 가격(price)의 평균
SELECT AVG(price) FROM book;
```


## MAX & MIN
> 테이블에서 가장 큰 값 또는 가장 작은 값을 구할 때 사용하는 집계 함수

```sql
-- 책 가격 중 가장 높은 값
SELECT MAX(price) FROM book;

-- 책 가격 중 가장 낮은 값
SELECT MIN(price) FROM book;
```


# 2. 다수의 테이블 제어하기

## 데이터 그룹 짓기
### GROUP BY
- rental 테이블

|rental_id|user_id|book_id|
|--|--|--|
|1|1|1000|
|2|1|1001|
|3|3|1004|

> user_id로 그룹을 짓는다면?

|user_id|count|
|--|--|
|1|2|
|3|1|

rental 테이블에서 user_id가 같은 데이터끼리 그룹화한 결과


```sql
SELECT user_id, COUNT(*)
FROM rental
GROUP BY user_id; -- user_id로 그룹을 짓고, 각 그룹의 개수를 세어라


-- 다양한 활용 예시
SELECT user_id, SUM(컬럼명)
FROM rental
GROUP BY user_id; -- user_id로 그룹을 짓고, 각 그룹의 합계를 구해라

SELECT user_id, AVG(컬럼명)
FROM rental
GROUP BY user_id; -- user_id로 그룹을 짓고, 각 그룹의 평균을 구해라

SELECT user_id, MAX(컬럼명)
FROM rental
GROUP BY user_id; -- user_id로 그룹을 짓고, 각 그룹의 최대값을 구해라

SELECT user_id, MIN(컬럼명)
FROM rental
GROUP BY user_id; -- user_id로 그룹을 짓고, 각 그룹의 최소값을 구해라
```



## 데이터 그룹에 조건 적용하기
### HAVING
> GROUP BY 절에서 조건을 넣고 싶다면?

```sql
SELECT user_id, COUNT(*)
FROM rental
GROUP BY user_id
HAVING COUNT(user_id) > 1; -- user_id로 그룹을 짓고, 각 그룹의 개수가 1보다 큰 것만 출력
```



## 두 개의 테이블에서 조회하기
### INNER JOIN
> 여러 테이블의 정보를 한번에 조회한다면?

```sql
SELECT *
FROM rental
INNER JOIN user; -- rental 테이블과 user 테이블을 조인하여 모든 데이터 조회
```

## 조건을 적용해 두 개의 테이블 조회하기
### ON
> JOIN에 조건을 적용하려면?

```sql
SELECT *
FROM rental
INNER JOIN user
ON user.id = rental.user_id; -- user 테이블의 id와 rental 테이블의 user_id가 같은 데이터만 조회
```


## LEFT JOIN
> LEFT JOIN은 왼쪽 테이블의 모든 데이터를 가져오고, 오른쪽 테이블의 데이터는 조건에 맞는 것만 가져온다.

```sql
SELECT *
FROM user -- 왼쪽 테이블
LEFT JOIN rental -- 오른쪽 테이블
ON user.id = rental.user_id; -- user 테이블의 id와 rental 테이블의 user_id가 같은 데이터만 조회
```

### INNER JOIN vs LEFT JOIN
| JOIN 유형      | 반환되는 데이터      | 설명                                                                                          |
|----------------|----------------------|-----------------------------------------------------------------------------------------------|
| **INNER JOIN** | 조건에 맞는 데이터만 | 두 테이블에 모두 존재하는 데이터만 반환. 한 테이블에만 존재하는 데이터는 제외됩니다.            |
| **LEFT JOIN**  | 왼쪽 테이블의 모든 데이터 + 조건에 맞는 오른쪽 데이터 | 왼쪽 테이블의 모든 데이터를 포함하고, 오른쪽 테이블의 조건에 맞는 데이터는 포함. 없으면 `NULL`. |



## RIGHT JOIN
> RIGHT JOIN은 오른쪽 테이블의 모든 데이터를 가져오고, 왼쪽 테이블의 데이터는 조건에 맞는 것만 가져온다.

```sql
SELECT *
FROM user
RIGHT JOIN rental
ON user.id = rental.user_id; -- user 테이블의 id와 rental 테이블의 user_id가 같은 데이터만 조회
```


### INNER JOIN vs RIGHT JOIN
| JOIN 유형      | 반환되는 데이터       | 설명                                                                                           |
|----------------|-----------------------|------------------------------------------------------------------------------------------------|
| **INNER JOIN** | 조건에 맞는 데이터만  | 두 테이블에 모두 존재하는 데이터만 반환. 한 테이블에만 존재하는 데이터는 제외됩니다.           |
| **RIGHT JOIN** | 오른쪽 테이블의 모든 데이터 + 조건에 맞는 왼쪽 데이터 | 오른쪽 테이블의 모든 데이터를 포함하고, 왼쪽 테이블의 조건에 맞는 데이터는 포함. 없으면 `NULL`. |

